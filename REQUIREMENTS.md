# 要件定義書: コードスニペット管理アプリ（Clibor進化版）

## 1. プロジェクト概要

### 1.1 プロジェクト名
**CodeSnippetManager** - プログラマー向け高機能スニペット管理アプリ

### 1.2 目的
プログラミング言語・ライブラリの関数やコードを階層的に管理し、素早く検索・挿入できるアプリケーションを開発する。Cliborのクリップボード管理機能に加え、プログラマー特化の機能を追加。

### 1.3 ターゲットユーザー
- プログラマー、エンジニア
- 複数の言語やライブラリを使用する開発者
- コードスニペットを効率的に管理したい人

---

## 2. 主要機能

### 2.1 階層的スニペット管理

#### 階層構造
```
言語 (Python, JavaScript, Java, etc.)
  └── ライブラリ/フレームワーク (NumPy, React, Spring, etc.)
      └── カテゴリ (ファイル操作, データ処理, etc.)
          └── スニペット (個別の関数・コード)
```

#### データ構造
各スニペットは以下の情報を持つ：
- **名前**: 関数名やスニペット名
- **言語**: Python, JavaScript, Java, C++, etc.
- **ライブラリ**: NumPy, Pandas, React, etc.
- **カテゴリ**: ファイル操作、データ処理、API呼び出し、etc.
- **説明**: 簡潔な説明文
- **詳細**: 詳しい使い方、引数の説明
- **コード**: 実際のコードサンプル
- **タグ**: 検索用のタグ（複数可）
- **使用頻度**: 使用回数（自動カウント）
- **最終使用日時**: 最後に使用した日時
- **お気に入り**: ブックマーク

### 2.2 検索・フィルタリング機能

#### インクリメンタルサーチ
- リアルタイム検索（入力しながら絞り込み）
- 複数キーワード対応（AND/OR検索）
- あいまい検索（Fuzzy Search）

#### フィルタ条件
- 言語で絞り込み
- ライブラリで絞り込み
- カテゴリで絞り込み
- タグで絞り込み
- お気に入りのみ表示
- 使用頻度順にソート

### 2.3 自動入力機能

#### ホットキー
- グローバルホットキー（例: `Ctrl+Shift+V`）でウィンドウを表示
- 検索後に `Enter` でコードを自動挿入
- クリップボードにコピーも可能

#### 挿入オプション
- カーソル位置に挿入
- クリップボードにコピー
- プレースホルダー置換（変数名などを自動置換）

### 2.4 スニペットの登録・編集

#### 登録方法
- GUI から手動登録
- クリップボードから取り込み
- ファイルからインポート（JSON, Markdown, etc.）
- GitHub Gist から取り込み

#### 編集機能
- シンタックスハイライト付きエディタ
- プレビュー機能
- タグの一括編集

### 2.5 データ管理

#### データベース
- SQLite でローカルに保存
- JSONファイルでエクスポート/インポート

#### バックアップ
- 自動バックアップ機能
- クラウド同期（Dropbox, Google Drive 対応）

### 2.6 Clibor互換機能

#### クリップボード履歴
- 通常のクリップボード履歴も管理
- 画像、テキスト、コードを自動分類
- 履歴からスニペットに変換

---

## 3. 技術仕様

### 3.1 開発言語
- **Python 3.9+**

### 3.2 使用ライブラリ

#### GUI
- **PyQt6** または **tkinter**: デスクトップアプリケーション
- **CustomTkinter**: モダンなUI（オプション）

#### データベース
- **SQLite3**: ローカルデータベース
- **SQLAlchemy**: ORM

#### その他
- **pyperclip**: クリップボード操作
- **keyboard**: ホットキー登録
- **Pygments**: シンタックスハイライト
- **fuzzywuzzy**: あいまい検索

### 3.3 対応プラットフォーム
- **Windows**: プライマリ
- **macOS**: セカンダリ
- **Linux**: オプション

---

## 4. データベース設計

### 4.1 テーブル構成

#### Languages（言語）
| カラム | 型 | 説明 |
|--------|-----|------|
| id | INTEGER PRIMARY KEY | ID |
| name | TEXT UNIQUE | 言語名 |
| icon | TEXT | アイコンパス |

#### Libraries（ライブラリ）
| カラム | 型 | 説明 |
|--------|-----|------|
| id | INTEGER PRIMARY KEY | ID |
| name | TEXT | ライブラリ名 |
| language_id | INTEGER | 言語ID（外部キー） |
| version | TEXT | バージョン |

#### Categories（カテゴリ）
| カラム | 型 | 説明 |
|--------|-----|------|
| id | INTEGER PRIMARY KEY | ID |
| name | TEXT | カテゴリ名 |
| parent_id | INTEGER | 親カテゴリID |

#### Snippets（スニペット）
| カラム | 型 | 説明 |
|--------|-----|------|
| id | INTEGER PRIMARY KEY | ID |
| name | TEXT | スニペット名 |
| language_id | INTEGER | 言語ID |
| library_id | INTEGER | ライブラリID |
| category_id | INTEGER | カテゴリID |
| description | TEXT | 簡潔な説明 |
| detail | TEXT | 詳細説明 |
| code | TEXT | コード本体 |
| tags | TEXT | タグ（カンマ区切り） |
| usage_count | INTEGER | 使用回数 |
| last_used | DATETIME | 最終使用日時 |
| favorite | BOOLEAN | お気に入り |
| created_at | DATETIME | 作成日時 |
| updated_at | DATETIME | 更新日時 |

---

## 5. UI/UX設計

### 5.1 メインウィンドウ

```
+--------------------------------------------------+
|  CodeSnippetManager                      [_][□][X] |
+--------------------------------------------------+
| [検索ボックス]                      [+新規] [設定]  |
+--------------------------------------------------+
| 言語   | ライブラリ  | カテゴリ  |  スニペット一覧   |
|--------|------------|----------|------------------|
| Python |            |          | ○ numpy.array()  |
|   └NumPy| NumPy     | 配列操作 |   配列を作成     |
|   └Pandas| Pandas   | データ   | ○ pd.read_csv()  |
| JS     |            |          |   CSVを読み込み  |
|   └React| React     |          | ○ useState()     |
| Java   |            |          |   状態管理       |
+--------------------------------------------------+
|  詳細プレビュー                                    |
|  関数名: numpy.array()                            |
|  説明: NumPy配列を作成する                         |
|  使用例:                                          |
|    import numpy as np                            |
|    arr = np.array([1, 2, 3])                     |
|  [クリップボードにコピー] [アクティブウィンドウに挿入] |
+--------------------------------------------------+
```

### 5.2 クイックアクセスウィンドウ（ホットキー起動）

```
+--------------------------------------------------+
| 🔍 検索: numpy array                              |
+--------------------------------------------------+
| ⭐ numpy.array() - 配列を作成                      |
| ⭐ numpy.zeros() - ゼロ配列を作成                  |
|   numpy.ones() - 1で埋めた配列を作成               |
|   numpy.arange() - 範囲指定で配列を作成            |
+--------------------------------------------------+
| ↑↓: 選択  Enter: 挿入  Esc: キャンセル             |
+--------------------------------------------------+
```

---

## 6. ユーザーストーリー

### 6.1 基本的な使い方

**シナリオ1: スニペットを検索して挿入**
1. ユーザーがコードエディタでプログラミング中
2. `Ctrl+Shift+V` を押してクイックアクセスウィンドウを表示
3. 「pandas read」と入力
4. `pd.read_csv()` が候補に表示される
5. `Enter` を押してコードが自動挿入される

**シナリオ2: 新しいスニペットを登録**
1. ユーザーがよく使うコードをコピー
2. メインウィンドウで「新規」ボタンをクリック
3. 言語、ライブラリ、カテゴリを選択
4. 説明とコードを入力
5. タグを追加して保存

**シナリオ3: 階層的に探す**
1. メインウィンドウを開く
2. 言語から「Python」を選択
3. ライブラリから「Pandas」を選択
4. カテゴリから「ファイル操作」を選択
5. `read_csv()`, `to_csv()` などが表示される

---

## 7. 非機能要件

### 7.1 パフォーマンス
- 検索結果は200ms以内に表示
- ホットキー反応時間: 100ms以内
- 1000件以上のスニペットを快適に管理

### 7.2 ユーザビリティ
- キーボード操作だけで全機能にアクセス可能
- 直感的なUI（学習コスト低）
- ダークモード対応

### 7.3 拡張性
- プラグインシステム（将来）
- カスタムテーマ
- API連携（GitHub, Stack Overflow）

---

## 8. 開発フェーズ

### Phase 1: MVP（最小viable製品）
- [ ] 基本的なGUI
- [ ] SQLiteデータベース
- [ ] スニペットのCRUD操作
- [ ] 基本的な検索機能
- [ ] クリップボードへのコピー

### Phase 2: コア機能
- [ ] 階層的な分類機能
- [ ] ホットキー機能
- [ ] 自動挿入機能
- [ ] インクリメンタルサーチ

### Phase 3: 拡張機能
- [ ] インポート/エクスポート
- [ ] シンタックスハイライト
- [ ] お気に入り機能
- [ ] 使用統計

### Phase 4: 高度な機能
- [ ] プレースホルダー置換
- [ ] クラウド同期
- [ ] GitHub Gist 連携
- [ ] プラグインシステム

---

## 9. 競合分析

### Clibor（クリップボード管理）
- ✓ 高速なクリップボード履歴
- ✗ プログラマー特化機能なし
- ✗ 階層的分類なし

### SnippetsLab（macOS）
- ✓ 階層的管理
- ✓ シンタックスハイライト
- ✗ Windowsで動作しない
- ✗ 高価（有料）

### Dash（ドキュメント管理）
- ✓ API ドキュメント管理
- ✗ カスタムスニペット管理が弱い

### 本アプリの優位性
- ✓ Clibor風の高速アクセス
- ✓ プログラマー特化
- ✓ 無料・オープンソース
- ✓ クロスプラットフォーム

---

## 10. リスクと対策

| リスク | 影響 | 対策 |
|--------|------|------|
| ホットキー衝突 | 中 | カスタマイズ可能に |
| データ肥大化 | 低 | データベース最適化 |
| UI の複雑化 | 中 | シンプルなデザイン |
| クラウド同期の複雑さ | 高 | Phase 4 で実装 |

---

## 11. 成功指標

- スニペット登録数: 100件以上
- 検索速度: 平均 100ms 以下
- ユーザー満足度: 4.5/5.0 以上
- 日次利用頻度: 10回以上

---

**作成日**: 2025-10-15
**バージョン**: 1.0
